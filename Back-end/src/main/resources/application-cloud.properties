# 啟動時測試數據庫連接
spring.datasource.test-on-connect=true
spring.datasource.test-on-borrow=true
spring.datasource.validation-query=SELECT 1

# 設置連接超時
spring.datasource.hikari.connection-timeout=5000

# 連接池設置
spring.datasource.hikari.minimum-idle=3
spring.datasource.hikari.maximum-pool-size=10

# 日誌設置 - 增加數據庫連接相關的日誌
logging.level.org.springframework.jdbc.core=INFO
logging.level.com.zaxxer.hikari=INFO

# 數據庫配置 - 這些屬性將由環境變量覆蓋，但作為默認值提供
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false

# 啟動時測試數據庫連接
spring.datasource.test-on-connect=true
spring.datasource.test-on-borrow=true
spring.datasource.validation-query=SELECT 1

# HikariCP 連接池設置
spring.datasource.hikari.connection-timeout=5000
spring.datasource.hikari.minimum-idle=3
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.idle-timeout=30000

# 使用環境變量的示例值（在 Cloud Run 會被實際環境變量替換）
# DB_NAME=staff_training_system_database
# DB_USER=root
# DB_PASSWORD=YOUR_PASSWORD
# CLOUD_SQL_CONNECTION_NAME=your-project:region:instance-name

# 日誌級別設置
logging.level.org.springframework.security=INFO
logging.level.org.springframework.web=INFO
logging.level.staff.training.system=INFO
# 增加數據庫連接相關的日誌
logging.level.org.springframework.jdbc.core=INFO
logging.level.com.zaxxer.hikari=INFO

# 伺服器端口配置 - 使用環境變量 PORT
server.port=${PORT:8080}

# SSL/HTTPS 配置
server.forward-headers-strategy=native

# Cloud SQL 禁用自動遷移（如果需要）
spring.flyway.enabled=false

# 允許的跨域源
# 這些在 SecurityConfig 中已配置，如果需要可以添加額外配置

# 啟用 Actuator 端點 (如果添加了 actuator 依賴)
management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always